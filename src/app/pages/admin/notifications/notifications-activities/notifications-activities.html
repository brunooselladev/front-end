<div class="app-page">
  <app-navbar></app-navbar>

  <div class="app-page__body">
    <app-sidebar></app-sidebar>

    <div class="app-page__content">
      <div class="page-header">
        <h1 class="page-header__title">Actividades Pendientes</h1>
      </div>

      <div class="page-main">
        <div class="cards-container">
          <!-- Loading state -->
          <div *ngIf="isLoading$ | async" class="loading-container">
            <app-loading-overlay
              [fullscreen]="false"
              message="Cargando actividades..."
              size="lg">
            </app-loading-overlay>
          </div>

          <!-- Content state -->
          <ng-container *ngIf="unverifiedActivities$ | async as activities">
            <ng-container *ngFor="let activity of activities">
              <app-card-notifications
                [userName]="activity.nombre"
                [espacioName]="getEspacioName(activity.espacioId)"
                [requestDate]="getCurrentDate()"
                [notificationId]="activity.id!.toString()"
                [hasUsmya]="false"
                [hasCreador]="false"
                [creadorTipo]="'actividad'"
                (viewDetails)="onViewDetails(activity.id!)"
                (accept)="onAcceptNotification(activity.id!)"
                (reject)="onRejectNotification(activity.id!)"
              ></app-card-notifications>
            </ng-container>

            <!-- Mensaje cuando no hay actividades -->
            <div *ngIf="activities.length === 0" class="empty-state">
              <div class="empty-state__content">
                <span class="empty-state__content__icon">ðŸŽ¯</span>
                <h3 class="empty-state__content__title">No hay actividades pendientes</h3>
                <p class="empty-state__content__description">
                  Todas las actividades han sido revisadas.
                </p>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>

    <!-- Side Menu para detalles -->
    <app-side-menu
      [isOpen]="sideMenuOpen"
      (closeMenu)="closeSideMenu()"
      [title]="'Detalles de la Actividad'"
    >
      <div *ngIf="selectedActivity" class="activity-details">
        <div class="activity-details__header">
          <h3 class="activity-details__title">{{ selectedActivity.nombre }}</h3>
        </div>

        <div class="activity-details__content">
          <div class="detail-section">
            <h4 class="detail-section__title">InformaciÃ³n General</h4>
            <div class="detail-item">
              <span class="detail-item__label">Fecha:</span>
              <span class="detail-item__value">{{ selectedActivity.dia | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-item__label">Horario:</span>
              <span class="detail-item__value">{{ selectedActivity.hora }}{{ selectedActivity.horaFin ? ' - ' + selectedActivity.horaFin : '' }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-item__label">Lugar:</span>
              <span class="detail-item__value">{{ selectedActivity.lugar }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-item__label">Responsable:</span>
              <span class="detail-item__value">{{ selectedActivity.responsable }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-item__label">Espacio:</span>
              <span class="detail-item__value">{{ getEspacioName(selectedActivity.espacioId) }}</span>
            </div>
            <div class="detail-item">
              <span class="detail-item__label">Tipo:</span>
              <span class="detail-item__value">{{ selectedActivity.esFija ? 'Actividad Fija' : 'Actividad Variable' }}</span>
            </div>
          </div>

          <div class="detail-section">
            <h4 class="detail-section__title">DescripciÃ³n</h4>
            <p class="activity-description">{{ selectedActivity.descripcion }}</p>
          </div>
        </div>

        <!-- Acciones -->
        <div class="activity-details__actions">
          <button
            class="activity-details__actions__button activity-details__actions__button--approve"
            (click)="onAcceptNotification(selectedActivity.id!)"
            *ngIf="!selectedActivity.isVerified"
          >
            âœ“ Aprobar Actividad
          </button>
          <button
            class="activity-details__actions__button activity-details__actions__button--reject"
            (click)="onRejectNotification(selectedActivity.id!)"
            *ngIf="!selectedActivity.isVerified"
          >
            âœ— Rechazar Actividad
          </button>
        </div>
      </div>
    </app-side-menu>

    <!-- Modal de confirmaciÃ³n -->
    <app-modal-confirmation
      [visible]="showModal"
      [message]="modalMessage"
      [type]="modalType"
      (confirm)="onModalConfirm()"
      (cancel)="onModalCancel()"
    ></app-modal-confirmation>
  </div>
</div>
