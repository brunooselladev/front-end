<div class="w-full max-w-5xl mx-auto md:px-10 md:py-6">
  <!-- Indicador de carga general -->
  <app-loading-overlay
    *ngIf="isLoadingTags"
    [fullscreen]="false"
    message="Cargando etiquetas..."
    size="sm">
  </app-loading-overlay>

  <!-- Mensaje de error -->
  <div *ngIf="loadingError" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
    <div class="flex items-center gap-2 text-red-700">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
      </svg>
      <span>{{ loadingError }}</span>
      <button
        (click)="loadTags()"
        class="ml-auto text-red-600 hover:text-red-800 underline text-sm">
        Reintentar
      </button>
    </div>
  </div>

  <!-- Contenido del formulario (solo mostrar cuando no hay carga ni error) -->
  <ng-container *ngIf="!isLoadingTags && !loadingError">
    <!-- Subtítulo descriptivo para modo agente -->
    <div class="mb-6">
      <p class="text-sm md:text-xl font-semibold text-gray-800">
        {{ isAgentRegistration ? 'Completa el resumen del USMyA para continuar con el registro (Opcional)' : isUsmya ? '' : 'Edita el resumen del USMyA para actualizar su información (Opcional)' }}
      </p>
    </div>
    <!-- Necesidades -->
    <div class="form-section">
      <app-input-summary
        label="Necesidades"
        placeholder="Describe brevemente tus necesidades actuales y lo que esperas del acompañamiento profesional..."
        [options]="necesidadesOptions"
        [maxLength]="500"
        [formControl]="necesidadesControl">
      </app-input-summary>
    </div>

    <!-- Deseos -->
    <div class="form-section mt-4">
      <app-input-summary
        label="Deseos"
        placeholder="¿Qué te gustaría lograr o mejorar en tu vida? Comparte tus aspiraciones y metas..."
        [options]="deseosOptions"
        [maxLength]="500"
        [formControl]="deseosControl">
      </app-input-summary>
    </div>

    <!-- Demandas -->
    <div class="form-section mt-4">
      <app-input-summary
        label="Demandas"
        placeholder="¿Qué recursos o apoyos específicos necesitas para mejorar tu situación?"
        [options]="demandasOptions"
        [maxLength]="500"
        [formControl]="demandasControl">
      </app-input-summary>
    </div>

    <!-- Intereses -->
    <div class="form-section mt-4">
      <app-input-summary
        label="Intereses"
        placeholder="¿Qué actividades o temas te interesan? ¿Qué te gusta hacer en tu tiempo libre?"
        [options]="interesesOptions"
        [maxLength]="500"
        [formControl]="interesesControl">
      </app-input-summary>
    </div>

    <!-- Botones de acción -->
    <div class="flex flex-col-reverse sm:flex-row justify-end gap-3 pt-6 border-t border-gray-200">
        <app-button
        *ngIf="isAgentRegistration"
          class="w-full sm:w-auto"
          [label]="'Volver'"
          variant="secondary"
          (clicked)="onCancel()">
        </app-button>
        <app-button
        *ngIf="!isAgentRegistration"
          class="w-full sm:w-auto"
          [label]="'Guardar cambios'"
          variant="primary"
          (clicked)="onSave()">
        </app-button>
        <app-button
        *ngIf="isAgentRegistration"
          class="w-full sm:w-auto"
          [label]="'Siguiente'"
          variant="primary"
          (clicked)="onNext()">
        </app-button>
      </div>
  </ng-container>
</div>
